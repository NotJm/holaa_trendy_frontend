<!-- Sidebar Component -->
<aside
  [class]="
    'fixed left-0 top-0 z-40 h-screen transition-all duration-300 ease-in-out bg-white border-r border-gray-200 flex flex-col ' +
    (sidebarService.isCollapsed() ? 'w-16' : 'w-64')
  "
>
  <!-- Header con toggle -->
  <div
    class="flex items-center justify-between p-4 border-b border-gray-100 flex-shrink-0"
  >
    <div
      [class]="
        'flex items-center gap-3 transition-all duration-300 ease-in-out ' +
        (sidebarService.isCollapsed()
          ? 'opacity-0 scale-95'
          : 'opacity-100 scale-100 delay-100')
      "
    >
      <image-control
        src="https://res.cloudinary.com/djy0fxyoq/image/upload/v1741215143/logo_ix9ohv.webp"
        alt="HOLAA Trendy"
        imageClass="h-8 w-auto"
      />
    </div>

    <!-- Toggle Button -->
    <button
      (click)="sidebarService.toggle()"
      class="p-2 rounded-lg hover:bg-gray-100 transition-colors duration-200 group flex-shrink-0"
    >
      <div
        [class]="
          'w-4 h-4 transition-transform duration-300 ease-in-out ' +
          (sidebarService.isCollapsed() ? 'rotate-180' : 'rotate-0')
        "
      >
        <span
          class="block w-full h-0.5 bg-gray-600 mb-1 transition-all duration-200 group-hover:bg-black"
        ></span>
        <span
          class="block w-full h-0.5 bg-gray-600 mb-1 transition-all duration-200 group-hover:bg-black"
        ></span>
        <span
          class="block w-full h-0.5 bg-gray-600 transition-all duration-200 group-hover:bg-black"
        ></span>
      </div>
    </button>
  </div>

  <!-- User Profile -->
  <div
    [class]="
      'p-4 border-b border-gray-100 transition-all duration-300 ease-in-out flex-shrink-0 ' +
      (sidebarService.isCollapsed() ? 'px-2' : 'px-4')
    "
  >
    <div class="flex items-center gap-3">
      <!-- Avatar -->
      <div class="relative flex-shrink-0">
        <div
          class="w-10 h-10 bg-black rounded-full flex items-center justify-center"
        >
          <span class="text-white text-sm font-medium">
            {{ userName.charAt(0).toUpperCase() || "U" }}
          </span>
        </div>
        <div
          class="absolute -bottom-1 -right-1 w-3 h-3 bg-white border border-gray-200 rounded-full flex items-center justify-center"
        ></div>
      </div>

      <!-- User Info -->
      <div
        [class]="
          'flex flex-col min-w-0 transition-all duration-300 ease-in-out ' +
          (sidebarService.isCollapsed()
            ? 'opacity-0 w-0 scale-95'
            : 'opacity-100 w-auto scale-100 delay-100')
        "
      >
        <span class="text-sm font-medium text-black truncate">
          {{ userName | titlecase }}
        </span>
        <span class="text-xs text-gray-500 truncate">
          {{ userEmail }}
        </span>
      </div>
    </div>
  </div>

  <!-- Navigation - Área scrolleable -->
  <div class="flex-1 overflow-y-auto overflow-x-hidden">
    <nav class="py-4">
      <!-- Main Menu -->
      <div class="px-3">
        <div
          [class]="
            'text-xs font-medium text-gray-400 uppercase tracking-wider mb-3 transition-all duration-300 ease-in-out ' +
            (sidebarService.isCollapsed()
              ? 'opacity-0 scale-95 px-1'
              : 'opacity-100 scale-100 px-3 delay-100')
          "
        >
          Principal
        </div>

        <div class="space-y-1">
          <!-- Dashboard -->
          <navigation-link
            link="/admin/home"
            linkActiveClass="bg-black text-white"
            [linkClass]="
              'flex items-center px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-100 hover:text-black transition-all duration-300 ease-in-out group ' +
              (sidebarService.isCollapsed()
                ? 'justify-center'
                : 'justify-start gap-3')
            "
            linkText="Inicio"
            [linkTextClass]="
              'text-sm font-medium whitespace-nowrap transition-all duration-300 ease-in-out ' +
              (sidebarService.isCollapsed()
                ? 'opacity-0 w-0 scale-95'
                : 'opacity-100 w-auto scale-100 delay-75')
            "
            [hasIcon]="true"
            iconClass="w-5 h-5 flex-shrink-0 icon-[mdi--home]"
          />

          <navigation-link
            link="/admin/orders"
            linkActiveClass="bg-black text-white"
            [linkClass]="
              'flex items-center px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-100 hover:text-black transition-all duration-300 ease-in-out group ' +
              (sidebarService.isCollapsed()
                ? 'justify-center'
                : 'justify-start gap-3')
            "
            linkText="Órdenes"
            [linkTextClass]="
              'text-sm font-medium whitespace-nowrap transition-all duration-300 ease-in-out ' +
              (sidebarService.isCollapsed()
                ? 'opacity-0 w-0 scale-95'
                : 'opacity-100 w-auto scale-100 delay-75')
            "
            [hasIcon]="true"
            iconClass="w-5 h-5 flex-shrink-0 icon-[mdi--package-variant-closed]"
          />

          <!-- Customers -->

          <navigation-link
            link="/admin/users"
            linkActiveClass="bg-black text-white"
            [linkClass]="
              'flex items-center px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-100 hover:text-black transition-all duration-300 ease-in-out group ' +
              (sidebarService.isCollapsed()
                ? 'justify-center'
                : 'justify-start gap-3')
            "
            linkText="Clientes"
            [linkTextClass]="
              'text-sm font-medium whitespace-nowrap transition-all duration-300 ease-in-out ' +
              (sidebarService.isCollapsed()
                ? 'opacity-0 w-0 scale-95'
                : 'opacity-100 w-auto scale-100 delay-75')
            "
            [hasIcon]="true"
            iconClass="w-5 h-5 flex-shrink-0 icon-[mdi--user-group]"
          />

          <!-- Statistics -->

          <navigation-link
            link="/admin/statistics"
            linkActiveClass="bg-black text-white"
            [linkClass]="
              'flex items-center px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-100 hover:text-black transition-all duration-300 ease-in-out group ' +
              (sidebarService.isCollapsed()
                ? 'justify-center'
                : 'justify-start gap-3')
            "
            linkText="Estadisticas"
            [linkTextClass]="
              'text-sm font-medium whitespace-nowrap transition-all duration-300 ease-in-out ' +
              (sidebarService.isCollapsed()
                ? 'opacity-0 w-0 scale-95'
                : 'opacity-100 w-auto scale-100 delay-75')
            "
            [hasIcon]="true"
            iconClass="w-5 h-5 flex-shrink-0 icon-[mdi--trending-up]"
          />
        </div>
      </div>

      <!-- Administration Section -->
      <div class="px-3 mt-8">
        <div
          [class]="
            'text-xs font-medium text-gray-400 uppercase tracking-wider mb-3 transition-all duration-300 ease-in-out ' +
            (sidebarService.isCollapsed()
              ? 'opacity-0 scale-95 px-1'
              : 'opacity-100 scale-100 px-3 delay-100')
          "
        >
          Administración
        </div>

        <div class="space-y-1">
          <!-- Audit -->
          <navigation-link
            link="/admin/audit"
            linkActiveClass="bg-black text-white"
            [linkClass]="
              'flex items-center px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-100 hover:text-black transition-all duration-300 ease-in-out group ' +
              (sidebarService.isCollapsed()
                ? 'justify-center'
                : 'justify-start gap-3')
            "
            linkText="Auditoria"
            [linkTextClass]="
              'text-sm font-medium whitespace-nowrap transition-all duration-300 ease-in-out ' +
              (sidebarService.isCollapsed()
                ? 'opacity-0 w-0 scale-95'
                : 'opacity-100 w-auto scale-100 delay-75')
            "
            [hasIcon]="true"
            iconClass="w-5 h-5 flex-shrink-0 icon-[mdi--file-search-outline]"
          />

          <!-- Incidents -->
          <navigation-link
            link="/admin/incidents"
            linkActiveClass="bg-black text-white"
            [linkClass]="
              'flex items-center px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-100 hover:text-black transition-all duration-300 ease-in-out group ' +
              (sidebarService.isCollapsed()
                ? 'justify-center'
                : 'justify-start gap-3')
            "
            linkText="Incidencias"
            [linkTextClass]="
              'text-sm font-medium whitespace-nowrap transition-all duration-300 ease-in-out ' +
              (sidebarService.isCollapsed()
                ? 'opacity-0 w-0 scale-95'
                : 'opacity-100 w-auto scale-100 delay-75')
            "
            [hasIcon]="true"
            iconClass="w-5 h-5 flex-shrink-0 icon-[mdi--alert-circle-outline]"
          />

          <!-- Business -->
          <navigation-link
            link="/admin/business"
            linkActiveClass="bg-black text-white"
            [linkClass]="
              'flex items-center px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-100 hover:text-black transition-all duration-300 ease-in-out group ' +
              (sidebarService.isCollapsed()
                ? 'justify-center'
                : 'justify-start gap-3')
            "
            linkText="Empresa"
            [linkTextClass]="
              'text-sm font-medium whitespace-nowrap transition-all duration-300 ease-in-out ' +
              (sidebarService.isCollapsed()
                ? 'opacity-0 w-0 scale-95'
                : 'opacity-100 w-auto scale-100 delay-75')
            "
            [hasIcon]="true"
            iconClass="w-5 h-5 flex-shrink-0 icon-[mdi--business]"
          />

          <!-- Documents -->
           <navigation-link
            link="/admin/documents"
            linkActiveClass="bg-black text-white"
            [linkClass]="
              'flex items-center px-3 py-2.5 rounded-lg text-gray-700 hover:bg-gray-100 hover:text-black transition-all duration-300 ease-in-out group ' +
              (sidebarService.isCollapsed()
                ? 'justify-center'
                : 'justify-start gap-3')
            "
            linkText="Documentos"
            [linkTextClass]="
              'text-sm font-medium whitespace-nowrap transition-all duration-300 ease-in-out ' +
              (sidebarService.isCollapsed()
                ? 'opacity-0 w-0 scale-95'
                : 'opacity-100 w-auto scale-100 delay-75')
            "
            [hasIcon]="true"
            iconClass="w-5 h-5 flex-shrink-0 icon-[mdi--document]"
          />
        </div>
      </div>
    </nav>
  </div>

  <!-- Footer - Botón de cerrar sesión FIJO en el fondo -->
  <div class="border-t border-gray-100 p-4 flex-shrink-0">
    <button-control
      (onClick)="logout()"
      [hasDisabledCondition]="true"
      [disabledCondition]="isLoading()"
      [buttonClass]="
        'flex items-center w-full px-3 py-2.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-gray-700 hover:text-black transition-all duration-300 ease-in-out disabled:opacity-50 disabled:cursor-not-allowed ' +
        (sidebarService.isCollapsed()
          ? 'justify-center'
          : 'justify-start gap-3')
      "
      [textButton]="isLoading() ? 'Cerrando...' : 'Cerrar Sesión'"
      [textClass]="
        'text-sm font-medium whitespace-nowrap transition-all duration-300 ease-in-out ' +
        (sidebarService.isCollapsed()
          ? 'opacity-0 w-0 scale-95'
          : 'opacity-100 w-auto scale-100 delay-100')
      "
      [hasIcon]="true"
      iconClass="w-5 h-5 flex-shrink-0 icon-[mdi--logout] transition-all duration-300 ease-in-out"
    />
  </div>
</aside>
